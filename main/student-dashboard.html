<!DOCTYPE html>

<html lang="en">

<head>

    <meta charset="UTF-8">
    <title>Student Dashboard</title>
    <link rel="stylesheet" href="css/student-dashboard.css">
    <link rel="stylesheet" href="css/dashboard.css">

</head>

<body>

    <div class="page-wrapper">

        <header class="page-header">

            <div class="page-header-content">

                <div>
                    <h1>Student Dashboard</h1>
                    <p>Welcome back, <span id="student-username">student</span>!</p>
                </div>

                <button id="switch-user-btn" class="btn btn-outline" type="button">
                    <svg class="icon" viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" fill="none" stroke-width="2">
                        <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"></path>
                        <path d="M16 17l5-5-5-5M21 12H9"></path>
                    </svg>
                    Switch User
                </button>

            </div>

        </header>

        <main class="container">

            <h2 class="mb-4">Your Participated Sessions</h2>
            
            <div class="flex flex-col gap-6">
                
                <section class="course-group">
                    <h3 class="course-title">Introduction to Computer Science</h3>

                    <div class="flex flex-col gap-3 ml-3">
                        
                        <div class="session-item">
                            <div>
                                <h4>Week 1: Introduction to Programming</h4>
                                <p class="session-info-1">CS101 - Week 1</p>
                                <p class="session-info-2">Submitted 2 days ago</p>
                            </div>
                            <div class="session-actions">
                                <button class="btn btn-outline btn-sm" onclick="showAnalytics('cs101-week1')">
                                    <svg class="icon" viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" fill="none"><path d="M3 3v18h18"></path><path d="M18 17V9M13 17V5M8 17v-3"></path></svg>
                                    View All Responses
                                </button>
                                <button class="btn btn-primary btn-sm" onclick="toggleFeedback('cs101-week1')">
                                    <svg class="icon" viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" fill="none"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"></path><path d="M14 2v6h6M16 13H8M16 17H8M10 9H8"></path></svg>
                                    View My Response
                                </button>
                            </div>
                        </div>

                        <div id="analytics-cs101-week1" style="display: none; margin: 1rem 0; padding: 1.5rem; background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 0.5rem; margin-left: 2%;">
                            <h4 style="margin-bottom: 1.5rem; color: #252525; font-weight: 600;">Class Analytics - CS101 Week 1</h4>
                            
                            <div class="analytics-card">
                                <h3>1. How clear was the lecture?</h3>
                                <div class="avg-score">★ 3.5 Average</div>
                                <div class="chart-container">
                                    <div class="chart-bar-wrapper"><div class="bar-value">2</div><div class="chart-bar filled" style="height: 10%;"></div><div class="bar-label">1</div></div>
                                    <div class="chart-bar-wrapper"><div class="bar-value">4</div><div class="chart-bar filled" style="height: 20%;"></div><div class="bar-label">2</div></div>
                                    <div class="chart-bar-wrapper"><div class="bar-value">9</div><div class="chart-bar filled" style="height: 45%;"></div><div class="bar-label">3</div></div>
                                    <div class="chart-bar-wrapper"><div class="bar-value">3</div><div class="chart-bar filled" style="height: 15%;"></div><div class="bar-label">4</div></div>
                                    <div class="chart-bar-wrapper"><div class="bar-value">1</div><div class="chart-bar filled" style="height: 5%;"></div><div class="bar-label">5</div></div>
                                </div>
                            </div>                            
                            
                            <button class="btn btn-outline btn-sm" onclick="hideAnalytics('cs101-week1')">Hide Analytics</button>
                        </div>

                        
                        <div id="feedback-cs101-week1" style="display: none; margin: 1rem 0; padding: 1rem; background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 0.5rem; margin-left: 2%;">
                            <h4 style="margin-bottom: 1rem; color: #252525; font-weight: 600;">My Feedback for CS101 - Week 1</h4>
                            
                            <div style="margin-bottom: 1.5rem;">
                                <p style="font-weight: 600; margin-bottom: 0.5rem;">How clear was the lecture?</p>
                                <div style="color: #fbbf24; font-size: 1.25rem; margin-bottom: 0.5rem;">★★★★☆</div>
                                <p style="color: #6b7280; font-size: 0.875rem;">I rated this 4 out of 5 stars.</p>
                            </div>
                            
                            <div style="margin-bottom: 1rem;">
                                <p style="font-weight: 600; margin-bottom: 0.5rem;">What worked well in this session?</p>
                                <div style="background: #f3f3f5; padding: 1rem; border-radius: 0.375rem; border-left: 4px solid #030213; font-style: italic;">
                                    I really appreciated how the professor broke down the basic programming concepts step by step. The examples were practical and helped me understand variables and data types much better. The pace felt just right for someone new to programming.
                                </div>
                            </div>
                            
                            <button class="btn btn-outline btn-sm" onclick="toggleFeedback('cs101-week1')">Hide Feedback</button>
                        </div>

                        <div class="session-item">
                            <div>
                                <h4>Week 2: Control Structures</h4>
                                <p class="session-info-1">CS101 - Week 2</p>
                                <p class="session-info-2">Submitted 1 week ago</p>
                            </div>
                            <div class="session-actions">
                                <button class="btn btn-outline btn-sm" onclick="">
                                    <svg class="icon" viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" fill="none"><path d="M3 3v18h18"></path><path d="M18 17V9M13 17V5M8 17v-3"></path></svg>
                                    View All Responses</button>
                                <button class="btn btn-primary btn-sm" onclick="toggleFeedback('cs101-week2')">
                                    <svg class="icon" viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" fill="none"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"></path><path d="M14 2v6h6M16 13H8M16 17H8M10 9H8"></path></svg>
                                    View My Response</button>
                            </div>
                        </div>

                        <div id="feedback-cs101-week2" style="display: none; margin: 1rem 0; padding: 1rem; background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 0.5rem; margin-left: 2%;">
                            <h4 style="margin-bottom: 1rem; color: #252525; font-weight: 600;">My Feedback for CS101 - Week 2</h4>
                            
                            <div style="margin-bottom: 1.5rem;">
                                <p style="font-weight: 600; margin-bottom: 0.5rem;">How clear was the lecture?</p>
                                <div style="color: #fbbf24; font-size: 1.25rem; margin-bottom: 0.5rem;">★★★★★</div>
                                <p style="color: #6b7280; font-size: 0.875rem;">I rated this 5 out of 5 stars.</p>
                            </div>
                            
                            <div style="margin-bottom: 1rem;">
                                <p style="font-weight: 600; margin-bottom: 0.5rem;">What worked well in this session?</p>
                                <div style="background: #f3f3f5; padding: 1rem; border-radius: 0.375rem; border-left: 4px solid #030213; font-style: italic;">
                                    The control structures examples were very clear and the step-by-step approach helped me understand loops and conditionals much better. The practice problems were especially helpful.
                                </div>
                            </div>
                            
                            <button class="btn btn-outline btn-sm" onclick="toggleFeedback('cs101-week2')">Hide Feedback</button>
                        </div>
                        
                    </div>
                </section>

                <section class="course-group">

                    <h3 class="course-title">Data Structures & Algorithms</h3>

                    <div class="flex flex-col gap-3 ml-3">
                        
                        <div class="session-item">
                            <div>
                                <h4>Week 1: Arrays and Lists</h4>
                                <p class="session-info-1">CS201 - Week 1</p>
                                <p class="session-info-2">Submitted 3 days ago</p>
                            </div>
                            <div class="session-actions">
                                <button class="btn btn-outline btn-sm" onclick="">
                                    <svg class="icon" viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" fill="none"><path d="M3 3v18h18"></path><path d="M18 17V9M13 17V5M8 17v-3"></path></svg>
                                    View All Responses</button>
                                <button class="btn btn-primary btn-sm" onclick="toggleFeedback('cs201-week1')">
                                    <svg class="icon" viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" fill="none"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"></path><path d="M14 2v6h6M16 13H8M16 17H8M10 9H8"></path></svg>
                                    View My Response</button>
                            </div>
                        </div>

                        <!-- Feedback section for CS201 Week 1 -->
                        <div id="feedback-cs201-week1" style="display: none; margin: 1rem 0; padding: 1rem; background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 0.5rem; margin-left: 2%;">
                            <h4 style="margin-bottom: 1rem; color: #252525; font-weight: 600;">My Feedback for CS201 - Week 1</h4>
                            
                            <div style="margin-bottom: 1.5rem;">
                                <p style="font-weight: 600; margin-bottom: 0.5rem;">How clear was the lecture?</p>
                                <div style="color: #fbbf24; font-size: 1.25rem; margin-bottom: 0.5rem;">★★★☆☆</div>
                                <p style="color: #6b7280; font-size: 0.875rem;">I rated this 3 out of 5 stars.</p>
                            </div>
                            
                            <div style="margin-bottom: 1rem;">
                                <p style="font-weight: 600; margin-bottom: 0.5rem;">What worked well in this session?</p>
                                <div style="background: #f3f3f5; padding: 1rem; border-radius: 0.375rem; border-left: 4px solid #030213; font-style: italic;">
                                    Arrays and lists concepts were introduced well, but the pace felt a bit fast for some of the more complex algorithms. More examples would have been helpful.
                                </div>
                            </div>
                            
                            <button class="btn btn-outline btn-sm" onclick="toggleFeedback('cs201-week1')">Hide Feedback</button>
                        </div>

                    </div>

                </section>

            </div>
        </main>
    </div>

</body>

<script>
function toggleFeedback(sessionId) {
    const feedbackElement = document.getElementById('feedback-' + sessionId);
    const analyticsElement = document.getElementById('analytics-' + sessionId);
    
    if (analyticsElement && analyticsElement.style.display === 'block') {
        analyticsElement.style.display = 'none';
    }
    
    if (feedbackElement.style.display === 'none') {
        feedbackElement.style.display = 'block';
    } else {
        feedbackElement.style.display = 'none';
    }
}

function showAnalytics(sessionId) {
    const analyticsElement = document.getElementById('analytics-' + sessionId);
    const feedbackElement = document.getElementById('feedback-' + sessionId);
    
    if (feedbackElement && feedbackElement.style.display === 'block') {
        feedbackElement.style.display = 'none';
    }
    
    analyticsElement.style.display = 'block';
}

function hideAnalytics(sessionId) {
    const analyticsElement = document.getElementById('analytics-' + sessionId);
    analyticsElement.style.display = 'none';
}

function getStudentUsername() {
    try {
        return (localStorage.getItem('studentUsername') || '').trim();
    } catch (e) {
        return '';
    }
}

function setStudentUsername(username) {
    try {
        localStorage.setItem('studentUsername', (username || '').trim());
    } catch (e) {
    
    }
}

function updateStudentUsernameUI() {
    const usernameEl = document.getElementById('student-username');
    if (!usernameEl) return;

    const username = getStudentUsername();
    usernameEl.textContent = username || 'student';
}

function showStudentUsernameModal() {
    const modal = document.createElement('div');
    modal.className = 'modal-overlay';

    modal.onclick = (e) => {
        if (e.target === modal) document.body.removeChild(modal);
    };

    modal.innerHTML = `
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3 class="modal-title">Choose a username</h3>
                <p class="modal-description">This name is used only to label your submissions.</p>
            </div>
            <form onsubmit="handleStudentUsernameSubmit(event)">
                <div class="modal-content">
                    <div class="form-group">
                        <label class="form-label">Username</label>
                        <input id="student-username-input" type="text" name="username" class="input" placeholder="e.g., student123" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline" onclick="window.location.href='auth.html'">Cancel</button>
                    <button type="submit" class="btn btn-primary">Weiter</button>
                </div>
            </form>
        </div>
    `;

    document.body.appendChild(modal);

    const input = modal.querySelector('#student-username-input');
    if (input) {
        input.value = getStudentUsername();
        input.focus();
        input.select();
    }
}

function handleStudentUsernameSubmit(e) {
    e.preventDefault();
    const formData = new FormData(e.target);
    const username = (formData.get('username') || '').toString().trim();
    if (!username) return;

    setStudentUsername(username);
    updateStudentUsernameUI();

    const modal = e.target.closest('.modal-overlay');
    if (modal) document.body.removeChild(modal);
}

document.addEventListener('DOMContentLoaded', () => {
    updateStudentUsernameUI();

    const username = getStudentUsername();
    if (!username) showStudentUsernameModal();

    const switchBtn = document.getElementById('switch-user-btn');
    if (switchBtn) {
        switchBtn.addEventListener('click', () => {
            setStudentUsername('');
            showStudentUsernameModal();
        });
    }
});
</script>

</html>
